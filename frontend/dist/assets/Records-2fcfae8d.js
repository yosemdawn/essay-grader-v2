import{d as H,r as _,D as L,C as k,c as J,b as O,e,w as a,h as Q,i as u,G as W,o as D,f as U,m as B,K,j as s,H as X,l as j,y as d,t as Y}from"./index-bd42a384.js";import{a as q,b as Z,g as ee}from"./records-ee9017a3.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";const ae={class:"records"},le=H({__name:"Records",setup(oe){const x=Q(),C=_(!1),f=_([]),b=_(0),y=_(1),w=_(20),v=_(""),m=_(""),g=_(!1),r=_(null),i=async()=>{C.value=!0;try{const l=(y.value-1)*w.value,t=w.value;let o;v.value?(o=await Z(v.value),f.value=o.records.slice(l,l+t),b.value=o.records.length):(o=await ee(l,t),f.value=o.records,b.value=o.total)}catch(l){k.error(l.message||"åŠ è½½è®°å½•å¤±è´¥")}finally{C.value=!1}},h=()=>{if(!m.value){i();return}const l=f.value.filter(t=>t.student_name.includes(m.value));f.value=l,b.value=l.length},E=()=>{v.value="",m.value="",y.value=1,i()},z=l=>l>=90?"success":l>=80?"primary":l>=60?"warning":"danger",R=l=>new Date(l).toLocaleString("zh-CN"),M=async l=>{try{const t=await q(l.id);r.value=t,g.value=!0}catch(t){k.error(t.message||"åŠ è½½è¯¦æƒ…å¤±è´¥")}};return L(()=>{const l=x.query.username,t=x.query.id;l&&(v.value=l),i(),t&&q(Number(t)).then(o=>{r.value=o,g.value=!0}).catch(o=>{k.error(o.message||"åŠ è½½è¯¦æƒ…å¤±è´¥")})}),(l,t)=>{const o=u("el-button"),S=u("el-input"),V=u("el-col"),P=u("el-row"),N=u("el-card"),c=u("el-table-column"),I=u("el-tag"),T=u("el-table"),$=u("el-pagination"),p=u("el-descriptions-item"),A=u("el-descriptions"),F=u("el-dialog"),G=W("loading");return D(),J("div",ae,[t[10]||(t[10]=O("h2",{class:"page-title"},"ðŸ“ æ‰¹é˜…è®°å½•",-1)),e(N,{class:"filter-card",shadow:"hover"},{default:a(()=>[e(P,{gutter:20},{default:a(()=>[e(V,{span:8},{default:a(()=>[e(S,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=n=>v.value=n),placeholder:"æŒ‰å­¦ç”Ÿç”¨æˆ·åç­›é€‰",clearable:"",onClear:i,onKeyup:U(i,["enter"])},{append:a(()=>[e(o,{icon:B(K),onClick:i},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),e(V,{span:8},{default:a(()=>[e(S,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=n=>m.value=n),placeholder:"æŒ‰å­¦ç”Ÿå§“åç­›é€‰",clearable:"",onClear:h,onKeyup:U(h,["enter"])},{append:a(()=>[e(o,{icon:B(K),onClick:h},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),e(V,{span:8},{default:a(()=>[e(o,{type:"primary",onClick:i},{default:a(()=>[...t[6]||(t[6]=[s("åˆ·æ–°",-1)])]),_:1}),e(o,{onClick:E},{default:a(()=>[...t[7]||(t[7]=[s("æ¸…é™¤ç­›é€‰",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"table-card",shadow:"hover"},{default:a(()=>[X((D(),j(T,{data:f.value,stripe:"",style:{width:"100%"}},{default:a(()=>[e(c,{prop:"id",label:"ID",width:"80"}),e(c,{prop:"essay_id",label:"ä½œæ–‡ID",width:"120"}),e(c,{prop:"student_name",label:"å­¦ç”Ÿå§“å",width:"120"}),e(c,{prop:"score",label:"åˆ†æ•°",width:"100"},{default:a(({row:n})=>[e(I,{type:z(n.score),size:"large"},{default:a(()=>[s(d(n.score),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"advantages",label:"ä¼˜ç‚¹","show-overflow-tooltip":"","min-width":"150"}),e(c,{prop:"disadvantages",label:"ä¸è¶³","show-overflow-tooltip":"","min-width":"150"}),e(c,{prop:"suggestions",label:"å»ºè®®","show-overflow-tooltip":"","min-width":"150"}),e(c,{prop:"graded_at",label:"æ‰¹é˜…æ—¶é—´",width:"180"},{default:a(({row:n})=>[s(d(R(n.graded_at)),1)]),_:1}),e(c,{label:"æ“ä½œ",width:"120",fixed:"right"},{default:a(({row:n})=>[e(o,{type:"primary",link:"",onClick:ne=>M(n)},{default:a(()=>[...t[8]||(t[8]=[s(" æŸ¥çœ‹è¯¦æƒ… ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,C.value]]),e($,{"current-page":y.value,"onUpdate:currentPage":t[2]||(t[2]=n=>y.value=n),"page-size":w.value,"onUpdate:pageSize":t[3]||(t[3]=n=>w.value=n),total:b.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:i,onCurrentChange:i,style:{"margin-top":"20px","justify-content":"center"}},null,8,["current-page","page-size","total"])]),_:1}),e(F,{modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=n=>g.value=n),title:"æ‰¹é˜…è¯¦æƒ…",width:"800px"},{footer:a(()=>[e(o,{onClick:t[4]||(t[4]=n=>g.value=!1)},{default:a(()=>[...t[9]||(t[9]=[s("å…³é—­",-1)])]),_:1})]),default:a(()=>[r.value?(D(),j(A,{key:0,column:2,border:""},{default:a(()=>[e(p,{label:"è®°å½•ID"},{default:a(()=>[s(d(r.value.id),1)]),_:1}),e(p,{label:"ä½œæ–‡ID"},{default:a(()=>[s(d(r.value.essay_id),1)]),_:1}),e(p,{label:"å­¦ç”Ÿå§“å"},{default:a(()=>[s(d(r.value.student_name),1)]),_:1}),e(p,{label:"åˆ†æ•°"},{default:a(()=>[e(I,{type:z(r.value.score),size:"large"},{default:a(()=>[s(d(r.value.score),1)]),_:1},8,["type"])]),_:1}),e(p,{label:"ä¼˜ç‚¹",span:2},{default:a(()=>[s(d(r.value.advantages),1)]),_:1}),e(p,{label:"ä¸è¶³",span:2},{default:a(()=>[s(d(r.value.disadvantages),1)]),_:1}),e(p,{label:"å»ºè®®",span:2},{default:a(()=>[s(d(r.value.suggestions),1)]),_:1}),e(p,{label:"æ‰¹é˜…äºº"},{default:a(()=>[s(d(r.value.graded_by),1)]),_:1}),e(p,{label:"æ‰¹é˜…æ—¶é—´"},{default:a(()=>[s(d(R(r.value.graded_at)),1)]),_:1})]),_:1})):Y("",!0)]),_:1},8,["modelValue"])])}}});const de=te(le,[["__scopeId","data-v-e80815be"]]);export{de as default};
