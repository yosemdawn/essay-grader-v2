import{d as B,r as f,D as N,c as V,b as s,e,w as a,g as A,C as E,i as n,G as I,o as w,y as _,j as u,H as L,l as M}from"./index-bd42a384.js";import{g as T}from"./users-c7770b4a.js";import{g as $}from"./records-ee9017a3.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";const z={class:"dashboard"},F={class:"stat-content"},G={class:"stat-info"},H={class:"stat-value"},U={class:"stat-content"},q={class:"stat-info"},J={class:"stat-value"},K={class:"stat-content"},O={class:"stat-info"},P={class:"stat-value"},Q={class:"stat-content"},W={class:"stat-info"},X={class:"stat-value"},Y={class:"card-header"},Z=B({__name:"Dashboard",setup(tt){const m=A(),v=f(!1),d=f({totalStudents:0,totalRecords:0,activeStudents:0,avgScore:"0"}),g=f([]),b=async()=>{v.value=!0;try{const o=await T({role:"student"});d.value.totalStudents=o.total,d.value.activeStudents=o.users.filter(l=>l.is_active).length;const t=await $(0,10);if(d.value.totalRecords=t.total,g.value=t.records,t.records.length>0){const l=t.records.reduce((r,p)=>r+p.score,0);d.value.avgScore=(l/t.records.length).toFixed(1)}}catch(o){E.error(o.message||"åŠ è½½æ•°æ®å¤±è´¥")}finally{v.value=!1}},y=o=>o>=90?"success":o>=80?"primary":o>=60?"warning":"danger",S=o=>new Date(o).toLocaleString("zh-CN"),x=()=>{m.push("/admin/records")},D=o=>{m.push(`/admin/records?id=${o}`)};return N(()=>{b()}),(o,t)=>{const l=n("el-card"),r=n("el-col"),p=n("el-row"),h=n("el-button"),i=n("el-table-column"),R=n("el-tag"),k=n("el-table"),C=I("loading");return w(),V("div",z,[t[11]||(t[11]=s("h2",{class:"page-title"},"ðŸ“Š æ•°æ®æ¦‚è§ˆ",-1)),e(p,{gutter:20,class:"stats-row"},{default:a(()=>[e(r,{xs:24,sm:12,md:6},{default:a(()=>[e(l,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",F,[t[1]||(t[1]=s("div",{class:"stat-icon student"},"ðŸ‘¨â€ðŸŽ“",-1)),s("div",G,[s("div",H,_(d.value.totalStudents),1),t[0]||(t[0]=s("div",{class:"stat-label"},"å­¦ç”Ÿæ€»æ•°",-1))])])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:6},{default:a(()=>[e(l,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",U,[t[3]||(t[3]=s("div",{class:"stat-icon record"},"ðŸ“",-1)),s("div",q,[s("div",J,_(d.value.totalRecords),1),t[2]||(t[2]=s("div",{class:"stat-label"},"æ‰¹é˜…è®°å½•",-1))])])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:6},{default:a(()=>[e(l,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",K,[t[5]||(t[5]=s("div",{class:"stat-icon active"},"âœ…",-1)),s("div",O,[s("div",P,_(d.value.activeStudents),1),t[4]||(t[4]=s("div",{class:"stat-label"},"æ´»è·ƒå­¦ç”Ÿ",-1))])])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:6},{default:a(()=>[e(l,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",Q,[t[7]||(t[7]=s("div",{class:"stat-icon avg"},"â­",-1)),s("div",W,[s("div",X,_(d.value.avgScore),1),t[6]||(t[6]=s("div",{class:"stat-label"},"å¹³å‡åˆ†æ•°",-1))])])]),_:1})]),_:1})]),_:1}),e(l,{class:"recent-records",shadow:"hover"},{header:a(()=>[s("div",Y,[t[9]||(t[9]=s("span",null,"ðŸ“‹ æœ€è¿‘æ‰¹é˜…è®°å½•",-1)),e(h,{type:"primary",link:"",onClick:x},{default:a(()=>[...t[8]||(t[8]=[u("æŸ¥çœ‹å…¨éƒ¨",-1)])]),_:1})])]),default:a(()=>[L((w(),M(k,{data:g.value,style:{width:"100%"},stripe:""},{default:a(()=>[e(i,{prop:"student_name",label:"å­¦ç”Ÿå§“å",width:"120"}),e(i,{prop:"essay_id",label:"ä½œæ–‡ID",width:"100"}),e(i,{prop:"score",label:"åˆ†æ•°",width:"80"},{default:a(({row:c})=>[e(R,{type:y(c.score)},{default:a(()=>[u(_(c.score),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"advantages",label:"ä¼˜ç‚¹","show-overflow-tooltip":""}),e(i,{prop:"graded_at",label:"æ‰¹é˜…æ—¶é—´",width:"180"},{default:a(({row:c})=>[u(_(S(c.graded_at)),1)]),_:1}),e(i,{label:"æ“ä½œ",width:"100"},{default:a(({row:c})=>[e(h,{type:"primary",link:"",onClick:st=>D(c.id)},{default:a(()=>[...t[10]||(t[10]=[u(" æŸ¥çœ‹è¯¦æƒ… ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[C,v.value]])]),_:1})])}}});const dt=j(Z,[["__scopeId","data-v-cd206a46"]]);export{dt as default};
